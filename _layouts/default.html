<!DOCTYPE html>
<html>

<head>
    <link rel="stylesheet" href="/static/style.css">
    <meta charset="utf-8">
    <title>{{ page.title }} - Marshall Mueller</title>
    
    <!-- KaTeX CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/katex.min.css" integrity="sha384-GvrOXuhMATgEsSwCs4smul74iXGOixntILdUW9XmUC6+HX0sLNAK3q71HotJqlAn" crossorigin="anonymous">
    
    <!-- KaTeX JavaScript -->
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/katex.min.js" integrity="sha384-cpW21h6RZv/phavutF+AuVYrr+dA8xD9zs6FwLpaCct6O9ctzYFfFr4dgmgccOTx" crossorigin="anonymous"></script>
    
    <!-- KaTeX auto-render -->
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/contrib/auto-render.min.js" integrity="sha384-+VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4+/RRE05" crossorigin="anonymous"></script>
    
    <!-- KaTeX macros -->
    <script src="/static/katex-macros.js"></script>

    <script>
        !function(t,e){var o,n,p,r;e.__SV||(window.posthog=e,e._i=[],e.init=function(i,s,a){function g(t,e){var o=e.split(".");2==o.length&&(t=t[o[0]],e=o[1]),t[e]=function(){t.push([e].concat(Array.prototype.slice.call(arguments,0)))}}(p=t.createElement("script")).type="text/javascript",p.async=!0,p.src=s.api_host.replace(".i.posthog.com","-assets.i.posthog.com")+"/static/array.js",(r=t.getElementsByTagName("script")[0]).parentNode.insertBefore(p,r);var u=e;for(void 0!==a?u=e[a]=[]:a="posthog",u.people=u.people||[],u.toString=function(t){var e="posthog";return"posthog"!==a&&(e+="."+a),t||(e+=" (stub)"),e},u.people.toString=function(){return u.toString(1)+".people (stub)"},o="init capture register register_once register_for_session unregister unregister_for_session getFeatureFlag getFeatureFlagPayload isFeatureEnabled reloadFeatureFlags updateEarlyAccessFeatureEnrollment getEarlyAccessFeatures on onFeatureFlags onSessionId getSurveys getActiveMatchingSurveys renderSurvey canRenderSurvey getNextSurveyStep identify setPersonProperties group resetGroups setPersonPropertiesForFlags resetPersonPropertiesForFlags setGroupPropertiesForFlags resetGroupPropertiesForFlags reset get_distinct_id getGroups get_session_id get_session_replay_url alias set_config startSessionRecording stopSessionRecording sessionRecordingStarted captureException loadToolbar get_property getSessionProperty createPersonProfile opt_in_capturing opt_out_capturing has_opted_in_capturing has_opted_out_capturing clear_opt_in_out_capturing debug".split(" "),n=0;n<o.length;n++)g(u,o[n]);e._i.push([i,s,a])},e.__SV=1)}(document,window.posthog||[]);
        posthog.init('phc_KacUPwgiDGKQ4gIshiTHnxWpY4Nd1XtTLB7QE2PqChA',{api_host:'https://us.i.posthog.com', person_profiles: 'identified_only' // or 'always' to create profiles for anonymous users as well
            })
    </script>
    
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Convert Jekyll footnotes to hover tooltips
            function convertJekyllFootnotes() {
                const footnoteLinks = document.querySelectorAll('a[href^="#fn:"]');
                const footnoteDefinitions = document.querySelectorAll('.footnotes li');
                
                footnoteLinks.forEach(function(link) {
                    // Extract footnote ID
                    const footnoteId = link.getAttribute('href').replace('#fn:', '');
                    
                    // Find corresponding footnote definition
                    const definition = document.getElementById('fn:' + footnoteId);
                    if (definition) {
                        // Get footnote text (remove the return link)
                        const footnoteText = definition.innerHTML.replace(/<a[^>]*>.*?<\/a>/g, '').trim();
                        
                        // Create tooltip element
                        const tooltip = document.createElement('span');
                        tooltip.className = 'footnote-content';
                        tooltip.innerHTML = footnoteText;
                        
                        // Add tooltip to link
                        link.appendChild(tooltip);
                        link.className = 'footnote';
                        
                        // Prevent default link behavior
                        link.addEventListener('click', function(e) {
                            e.preventDefault();
                        });
                    }
                });
            }
            
            // Convert Jekyll footnotes first
            convertJekyllFootnotes();
            
            // Then set up hover functionality
            const footnotes = document.querySelectorAll('.footnote');
            
            footnotes.forEach(function(footnote) {
                const content = footnote.querySelector('.footnote-content');
                if (!content) return;
                
                footnote.addEventListener('mouseenter', function() {
                    // Get footnote trigger position
                    const triggerRect = footnote.getBoundingClientRect();
                    const windowWidth = window.innerWidth;
                    const windowHeight = window.innerHeight;
                    
                    // Position footnote above the trigger
                    let top = triggerRect.top - 10; // 10px gap above trigger
                    let left = triggerRect.left + (triggerRect.width / 2);
                    
                    // Set initial position
                    content.style.top = top + 'px';
                    content.style.left = left + 'px';
                    content.style.transform = 'translate(-50%, -100%)';
                    
                    // Show temporarily to measure
                    content.style.opacity = '1';
                    content.style.visibility = 'visible';
                    
                    const contentRect = content.getBoundingClientRect();
                    
                    // Adjust horizontal position if off screen
                    if (contentRect.left < 10) {
                        content.style.transform = 'translate(0, -100%)';
                        content.style.left = '10px';
                    } else if (contentRect.right > windowWidth - 10) {
                        content.style.transform = 'translate(-100%, -100%)';
                        content.style.left = (windowWidth - 10) + 'px';
                    }
                    
                    // If footnote would go above viewport, show it below instead
                    if (contentRect.top < 10) {
                        const newTop = triggerRect.bottom + 10;
                        content.style.top = newTop + 'px';
                        content.style.transform = content.style.transform.replace('-100%)', '0)');
                        content.classList.add('below');
                    } else {
                        content.classList.remove('below');
                    }
                    
                    // Hide again for smooth transition
                    content.style.opacity = '0';
                    content.style.visibility = 'hidden';
                    
                    // Show with transition
                    setTimeout(() => {
                        content.style.opacity = '1';
                        content.style.visibility = 'visible';
                    }, 10);
                });
                
                footnote.addEventListener('mouseleave', function() {
                    content.style.opacity = '0';
                    content.style.visibility = 'hidden';
                });
            });
        });
        
        // Initialize KaTeX auto-render when page loads
        document.addEventListener('DOMContentLoaded', function() {
            renderMathInElement(document.body, {
                delimiters: [
                    {left: '$$', right: '$$', display: true},
                    {left: '$', right: '$', display: false},
                    {left: '\\(', right: '\\)', display: false},
                    {left: '\\[', right: '\\]', display: true}
                ],
                macros: window.katexMacros || {},
                throwOnError: false
            });
        });
    </script>
</head>

<body>
    <div class="background-gradient"></div>
    <div class="vertical-line left"></div>
    <!-- Header with Menu Line -->
    <header>
        <div class="menu-line">
            <a href="/" class="site-title">Marshall Mueller</a>
            <nav class="menu">
                <ul>
                    <li><a href="/writing">Writing</a></li>
                    <li><a href="/bookshelf">Bookshelf</a></li>
                    <li><a href="/photography">Photography</a></li>
                    <li><a href="/filmclub">Film Club</a></li>
                </ul>
            </nav>
        </div>
    </header>

    <!-- Main Content with Vertical Lines -->
    <div class="main-content">
        <div class="vertical-line left"></div>
        <div id="contentbox">
            <div id="content">
                {{ content }}
            </div>
        </div>
        
    </div>
    <div class="vertical-line right"></div>

</body>

</html>
